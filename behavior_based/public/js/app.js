var requirejs,require,define;!function(e){function t(e,t){return y.call(e,t)}function i(e,t){var i,n,o,a,r,s,c,l,u,m,p,d=t&&t.split("/"),f=h.map,g=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),r=e.length-1,h.nodeIdCompat&&w.test(e[r])&&(e[r]=e[r].replace(w,"")),e=d.concat(e),u=0;u<e.length;u+=1)if(p=e[u],"."===p)e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||g)&&f){for(i=e.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(m=d.length;m>0;m-=1)if(o=f[d.slice(0,m).join("/")],o&&(o=o[n])){a=o,s=u;break}if(a)break;!c&&g&&g[n]&&(c=g[n],l=u)}!a&&c&&(a=c,s=l),a&&(i.splice(0,s,a),e=i.join("/"))}return e}function n(t,i){return function(){var n=M.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),u.apply(e,n.concat([t,i]))}}function o(e){return function(t){return i(t,e)}}function a(e){return function(t){d[e]=t}}function r(i){if(t(f,i)){var n=f[i];delete f[i],g[i]=!0,l.apply(e,n)}if(!t(d,i)&&!t(g,i))throw new Error("No "+i);return d[i]}function s(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function c(e){return function(){return h&&h.config&&h.config[e]||{}}}var l,u,m,p,d={},f={},h={},g={},y=Object.prototype.hasOwnProperty,M=[].slice,w=/\.js$/;m=function(e,t){var n,a=s(e),c=a[0];return e=a[1],c&&(c=i(c,t),n=r(c)),c?e=n&&n.normalize?n.normalize(e,o(t)):i(e,t):(e=i(e,t),a=s(e),c=a[0],e=a[1],c&&(n=r(c))),{f:c?c+"!"+e:e,n:e,pr:c,p:n}},p={require:function(e){return n(e)},exports:function(e){var t=d[e];return"undefined"!=typeof t?t:d[e]={}},module:function(e){return{id:e,uri:"",exports:d[e],config:c(e)}}},l=function(i,o,s,c){var l,u,h,y,M,w,v=[],b=typeof s;if(c=c||i,"undefined"===b||"function"===b){for(o=!o.length&&s.length?["require","exports","module"]:o,M=0;M<o.length;M+=1)if(y=m(o[M],c),u=y.f,"require"===u)v[M]=p.require(i);else if("exports"===u)v[M]=p.exports(i),w=!0;else if("module"===u)l=v[M]=p.module(i);else if(t(d,u)||t(f,u)||t(g,u))v[M]=r(u);else{if(!y.p)throw new Error(i+" missing "+u);y.p.load(y.n,n(c,!0),a(u),{}),v[M]=d[u]}h=s?s.apply(d[i],v):void 0,i&&(l&&l.exports!==e&&l.exports!==d[i]?d[i]=l.exports:h===e&&w||(d[i]=h))}else i&&(d[i]=s)},requirejs=require=u=function(t,i,n,o,a){if("string"==typeof t)return p[t]?p[t](i):r(m(t,i).f);if(!t.splice){if(h=t,h.deps&&u(h.deps,h.callback),!i)return;i.splice?(t=i,i=n,n=null):t=e}return i=i||function(){},"function"==typeof n&&(n=o,o=a),o?l(e,t,i,n):setTimeout(function(){l(e,t,i,n)},4),u},u.config=function(e){return u(e)},requirejs._defined=d,define=function(e,i,n){i.splice||(n=i,i=[]),t(d,e)||t(f,e)||(f[e]=[e,i,n])},define.amd={jQuery:!0}}(),define("../vendor/bower_components/almond/almond",function(){}),define("application/config/config",[],function(){return{name:"sample project",namespace:"My",base_url:window.BASE_URL||"",container:"#container",globalChannelName:"global",mainModule:"code_route",urlPushState:"undefined"!=typeof window.enablePushState?window.enablePushState:Modernizr&&Modernizr.history}}),define("system/core/marionette.my.app_router",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].AppRouter=Marionette.AppRouter}),define("system/core/marionette.my.application",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Application=Marionette.Application}),define("system/core/marionette.my.behavior",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Behavior=Marionette.Behavior.extend({triggerViewMethod:function(e,t){var i="on"+e.charAt(0).toUpperCase()+e.slice(1);this.view&&this.view[i]&&this.view[i].call(this.view,t)}})}),define("system/core/marionette.my.behaviors",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Behaviors=Marionette.Behaviors}),define("system/core/marionette.my.callbacks",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Callbacks=Marionette.Callbacks}),define("system/core/marionette.my.collection_view",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].CollectionView=Marionette.CollectionView.extend({template:!1})}),define("system/core/marionette.my.composite_view",["application/config/config"],function(){Marionette.My||(Marionette.My={}),Marionette.My.CompositeView=Marionette.CompositeView.extend({template:!1})}),define("system/core/marionette.my.controller",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Controller=Marionette.Controller}),define("system/core/marionette.my.item_view",["application/config/config"],function(){Marionette.My||(Marionette.My={}),Marionette.My.ItemView=Marionette.ItemView.extend({template:!1})}),define("system/core/marionette.my.layout_view",["application/config/config"],function(){Marionette.My||(Marionette.My={}),Backbone.Marionette.My.LayoutView=Backbone.Marionette.LayoutView.extend({template:!1,regionClass:Marionette.My.Region,removeView:function(e,t){this[e]&&(this[e].empty(),"function"==typeof t&&t())},setView:function(e,t,i,n){if(e&&t&&this[t]){if(this[t].currentView===e)return;this[t].show(e,i,n)}}})}),define("system/core/marionette.my.module",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Module=Marionette.Module}),define("system/core/marionette.my.object",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Object=Marionette.Object}),define("application/helper/transitions",[],function(){return{fade:function(e,t,i){TweenLite.to(e.$el,0,{display:"none"}),TweenLite.fromTo(t.$el,1,{opacity:0},{opacity:1,delay:.05,onComplete:function(){i()}})},cut:function(e,t,i){i()},slideFromRight:function(e,t,i){var n=t.$el.parent().width();TweenLite.fromTo(e.$el,.4,{zIndex:1},{x:-n,opacity:.8}),TweenLite.fromTo(t.$el,.4,{zIndex:2,x:n},{x:0,onComplete:function(){i()}})},slideFromLeft:function(e,t,i){var n=t.$el.parent().width();TweenLite.fromTo(e.$el,.4,{zIndex:1},{x:n,opacity:.8}),TweenLite.fromTo(t.$el,.4,{zIndex:2,x:-n},{x:0,onComplete:function(){i()}})},slideFromBottom:function(e,t,i){var n=t.$el.parent().height();TweenLite.fromTo(e.$el,.4,{zIndex:1},{y:n,opacity:.8}),TweenLite.fromTo(t.$el,.4,{zIndex:2,y:-n},{y:0,onComplete:function(){i()}})},slideFromTop:function(e,t,i){var n=t.$el.parent().height();TweenLite.fromTo(e.$el,.4,{zIndex:1},{y:n,opacity:.8}),TweenLite.fromTo(t.$el,.4,{zIndex:2,y:-n},{y:0,onComplete:function(){i()}})}}}),define("system/core/marionette.my.region",["application/helper/transitions","application/config/config"],function(e,t){Marionette[t.namespace]||(Marionette[t.namespace]={}),Marionette[t.namespace].Region=Marionette.Region.extend({transitions:{},initialize:function(){this.addTransitions(e)},addTransition:function(e,t){this.transitions[e]=t},addTransitions:function(e){this.transitions=_.extend(this.transitions,e)},show:function(e,t){this._ensureElement();var i=$.extend({transition:"cut"},t||{}),n=e!==this.currentView,o=!!i.preventDestroy,a=!!i.forceShow;return this.isChangingView=!!this.currentView,this._shouldDestroyView=!o&&n&&"undefined"!=typeof this.currentView,this._shouldDestroyView&&this.transitions[i.transition]?this.swap(e,this.transitions[i.transition]):(n||a)&&this.open(e),this},open:function(e){return e.render(),this.onBeforeViewShow(e),this.attachHtml(e),this.currentView=e,this.onViewShow(e),this},swap:function(e,t){var i=this;e.render(),this.attachSwapHtml(e),this.onBeforeViewShow(e),_.isFunction(this.currentView.triggerMethod)?this.currentView.triggerMethod("disable"):this.triggerMethod.call(this.currentView,"disable"),this.triggerMethod("before:swap",this.currentView,e),t.call(i,i.currentView,e,function(){i.transitionEnd(e)})},attachSwapHtml:function(e){this.el.appendChild(e.el)},transitionEnd:function(e){this.currentView.destroy&&!this.currentView.isDestroyed?this.currentView.destroy():this.currentView.remove&&this.currentView.remove(),this.currentView=e,this.onViewShow(e)},onBeforeViewShow:function(e){this.triggerMethod("before:show",e),_.isFunction(e.triggerMethod)?e.triggerMethod("before:show"):this.triggerMethod.call(e,"before:show"),e.onBeforeShow&&e.onBeforeShow(e)},onViewShow:function(e){this.triggerMethod("show",e),_.isFunction(e.triggerMethod)?e.triggerMethod("show"):this.triggerMethod.call(e,"show")}})}),define("system/core/marionette.my.region_manager",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].RegionManager=Marionette.RegionManager}),define("system/core/marionette.my.renderer",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].Renderer=Marionette.Renderer}),define("system/core/marionette.my.sub_router",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].SubRouter=Marionette.SubRouter}),define("system/core/marionette.my.template_cache",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].TemplateCache=Marionette.TemplateCache}),define("system/core/marionette.my.view",["application/config/config"],function(e){Marionette[e.namespace]||(Marionette[e.namespace]={}),Marionette[e.namespace].View=Marionette.View}),define("system/application",["application/config/config","system/core/marionette.my.app_router","system/core/marionette.my.application","system/core/marionette.my.behavior","system/core/marionette.my.behaviors","system/core/marionette.my.callbacks","system/core/marionette.my.collection_view","system/core/marionette.my.composite_view","system/core/marionette.my.controller","system/core/marionette.my.item_view","system/core/marionette.my.layout_view","system/core/marionette.my.module","system/core/marionette.my.object","system/core/marionette.my.region","system/core/marionette.my.region_manager","system/core/marionette.my.renderer","system/core/marionette.my.sub_router","system/core/marionette.my.template_cache","system/core/marionette.my.view"],function(e){return new Marionette[e.namespace].Application({channelName:e.globalChannelName})}),define("system/application_message_bus",["application/config/config"],function(e){return Marionette[e.namespace]||(Marionette[e.namespace]={}),Backbone.Marionette[e.namespace].messageBus={},Backbone.Marionette[e.namespace].messageBus[e.globalChannelName]=Backbone.Wreqr.radio.channel(e.globalChannelName),Backbone.Marionette[e.namespace].messageBus[e.globalChannelName]}),define("system/application_controller",["application/config/config"],function(e){var t=Marionette[e.namespace].Controller.extend({initialize:function(e){this.options=e.opt,this.application=e.app,this.mainModule=e.opt.mainModule,this.lastRouteName=null,this.lastModule=null},index:function(e){this.application[this.mainModule]&&(this.application.module(this.mainModule).start(e),this.lastRouteName=this.mainModule,this.lastModule=this.mainModule)},runModule:function(e){var t;this.moduleRoutes&&this.moduleRoutes[e]&&(t=this.moduleRoutes[e]),_.each(this.moduleRoutes,function(i,n){t=-1!=_.indexOf(i,e)?n:t}),t&&this.application[t]||this.index.apply(this,arguments),this.application[t]&&(null!==this.lastRouteName&&e!==this.lastRouteName&&this.application.module(this.lastModule).stop(),this.application.module(t).start(e),this.lastRouteName=e,this.lastModule=t)}});return t}),define("application/config/module_routes",[],function(){var e={code_route:["code_route"]};return e}),define("system/application_router",["application/config/config","system/application_controller","application/config/module_routes"],function(e,t,i){var n=Marionette[e.namespace].AppRouter.extend({initialize:function(i){this.controller=new t(i),this.controller.moduleRoutes=this.moduleRoutes,Marionette[e.namespace].AppRouter.prototype.initialize.apply(this,arguments)},appRoutes:{":module(/*subRoute)":"runModule","*actions":"index"},moduleRoutes:i});return n}),define("system/application_layout",["application/config/config","system/core/marionette.my.layout_view"],function(e){var t=Marionette[e.namespace].LayoutView.extend({regions:{header:new Marionette[e.namespace].Region({el:"#header"}),content:new Marionette[e.namespace].Region({el:"#content"}),footer:new Marionette[e.namespace].Region({el:"#footer"})},initialize:function(){this.addRegions({modal:"#modal"}),this.$el.append('<div id="modal"></div>'),Marionette[e.namespace].LayoutView.prototype.initialize.apply(this,arguments)}});return t}),define("system/application_initializer",["system/application","system/application_message_bus","system/application_router","system/application_layout","application/config/config"],function(e,t,i,n,o){var a=new n;return e.addInitializer(function(){e.addRegions({mainRegion:o.container}),a.template!==!1&&e.mainRegion.show(a)}),e.addInitializer(function(){$(window).on("scroll",function(e){t.vent.trigger("custom:scroll",e)}),$(window).on("resize",function(e){t.vent.trigger("custom:resize",e)})}),e.addInitializer(function(){t.commands.setHandler("setView",function(e,t,i,n){a.setView(e,t,i,n)}),t.commands.setHandler("removeView",function(e,t,i){a.removeView(e,t,i)}),t.commands.setHandler("fadeOut",function(e,t){a.fadeOut(500,e,t)}),t.commands.setHandler("fadeIn",function(e,t){a.fadeIn(500,e,t)})}),e.addInitializer(function(){t.reqres.setHandler("getApp",function(){return e})}),e.addInitializer(function(){t.reqres.setHandler("getSettings",function(){return o})}),e.addInitializer(function(){Marionette[o.namespace].Behaviors.behaviorsLookup=function(){return Marionette[o.namespace].BehaviorsLookup}}),e.addInitializer(function(){new i({app:e,opt:o})}),e.on("start",function(){var e={};e.pushState=o.urlPushState,e.silent=!1,o.base_url&&(e.root=o.base_url),Backbone.history.start(e)}),e}),define("system/behavior/handlebars",["application/config/config"],function(e){var t=Marionette[e.namespace].Behavior.extend({initialize:function(){"string"==typeof this.view.template&&(this.view.template=hbsTemplate[this.view.template])}});return t}),define("application/module/code_route/view/layout",["system/behavior/handlebars"],function(e){var t=Marionette.My.LayoutView.extend({template:"application/module/code_route/view/template/layout",className:"code-route",regionClass:Marionette.My.Region,behaviors:{handlebars:{behaviorClass:e}},regions:{header:".layout-header",content:".layout-content",footer:".layout-footer"}});return t}),define("application/module/code_route/view/start_view",["system/behavior/handlebars"],function(e){var t=Marionette.My.ItemView.extend({template:"application/module/code_route/view/template/intro",className:"introduction",ui:{start:".start"},events:{"click @ui.start":"startBtn"},behaviors:{handlebars:{behaviorClass:e}},startBtn:function(){Marionette.My.messageBus.global.vent.trigger("btnStart")}});return t}),define("application/module/code_route/view/end_view",["system/behavior/handlebars"],function(e){var t=Marionette.My.ItemView.extend({template:"application/module/code_route/view/template/result",className:"result",behaviors:{handlebars:{behaviorClass:e}},events:{"click .icon-facebook":"shareFacebook"},initialize:function(e){this.isValid=e.isValid,this.serializeData=_.bind(function(){return{result:this[e.isValid?"getOkText":"getKoText"](),validClass:e.isValid?"icon-ok-circled":"icon-cancel-circled"}},this)},getOkText:function(){return this.model.get("resultOkText")[_.random(0,this.model.get("resultOkText").length-1)]},getKoText:function(){return this.model.get("resultKoText")[_.random(0,this.model.get("resultKoText").length-1)]},shareFacebook:function(e){e.preventDefault();var t={method:"feed",picture:"http://www.potiondevie.fr/wp-content/uploads/2013/01/coderoute.jpg",name:this.isValid?"J'ai réussi le test, et toi ?":"Je n'ai pas réussi le test...",caption:"Un test de 1 question.",description:"Etes vous prêt à relever le défi ?",link:window.location.href};FB.ui(t,$.noop)}});return t}),define("application/module/code_route/model/question_model",[],function(){var e=Backbone.Model.extend({});return e}),define("application/module/code_route/collection/question_collection",["application/module/code_route/model/question_model"],function(e){var t=Backbone.Collection.extend({model:e,url:"contrib/questions.json"});return t}),define("application/module/code_route/view/question_view",["application/module/code_route/collection/question_collection","system/behavior/handlebars"],function(e,t){var i;return i=Marionette.My.ItemView.extend({template:"application/module/code_route/view/template/question",ui:{form:".response-form",image:".question-image"},events:{"submit @ui.form":"submitForm","mousedown @ui.image":"hideForm","mouseup @ui.image":"showForm","touchstart @ui.image":"hideForm","touchend @ui.image":"showForm"},behaviors:{handlebars:{behaviorClass:t}},collection:new e,initialize:function(){this.collection.fetch().then(_.bind(function(){this.setQuestion()},this)),Marionette.My.messageBus.global.vent.on("updateTimer",_.bind(this.updateTime,this)),Backbone.Marionette.My.ItemView.prototype.initialize.apply(this,arguments)},updateTime:function(e){this.$el.find(".progress").width(e+"%")},hideForm:function(e){e.currentTarget.isHidded?(this.showForm(),e.currentTarget.isHidded=!1):(TweenLite.to(this.$el.find("form"),.25,{opacity:.1}),e.currentTarget.isHidded=!0)},showForm:function(e){e&&e.currentTarget.isHidded&&(e.currentTarget.isHidded=!1),TweenLite.to(this.$el.find("form"),.25,{opacity:1})},setQuestion:function(){var e="abcdefghijklmnopqrstuvwxyz".split(""),t=this.collection.at(_.random(0,this.collection.length-1));t.attributes.responses=_.shuffle(t.attributes.responses),_.each(t.attributes.responses,function(i,n){t.attributes.responses[n].letter=e[n]}),this.model=t,this.render()},render:function(){this.model&&Backbone.Marionette.My.ItemView.prototype.render.apply(this,arguments)},onAfterRender:function(){TweenLite.fromTo(this.$el.find(".response-form"),1,{y:window.innerHeight},{y:0,ease:Cubic.easeOut})},submitForm:function(e){e.preventDefault(),this.checkResponse(e.currentTarget)},checkResponse:function(e){var t=this.$(e),i=!0,n=this.model.get("responses");t.find("[name=responses]").each(function(e,t){for(var o=$(t),a=o.val(),r=0,s=n.length;s>r;r++)a==n[r].value&&(o.is(":checked")&&!n[r].valid?i=!1:o.is(":not(:checked)")&&n[r].valid&&(i=!1))}),Marionette.My.messageBus.global.vent.trigger("end",{isValid:i})}})}),define("application/module/code_route/model/i18n_model",[],function(){var e=Backbone.Model.extend({url:"contrib/i18n.json"});return e}),define("application/module/code_route/controller/controller",["application/module/code_route/view/layout","application/module/code_route/view/start_view","application/module/code_route/view/end_view","application/module/code_route/view/question_view","application/module/code_route/model/i18n_model"],function(e,t,i,n,o){var a;return a=Marionette.My.Controller.extend({timer:{},layout:null,initialize:function(){Marionette.My.messageBus.global.vent.on("btnStart",_.bind(this.hideModal,this)),Marionette.My.messageBus.global.vent.on("end",_.bind(this.questionEnd,this))},index:function(){this.layout=new e,Marionette.My.messageBus.global.commands.execute("setView",this.layout,"content",{transition:"fade"}),this.i18nModel=new o,this.i18nModel.fetch().then(_.bind(function(){clearInterval(this.timer.interval),this.layout.setView(new t({model:this.i18nModel}),"content",{transition:"fade"})},this))},hideModal:function(){this.layout.setView(new n,"content",{transition:"fade"}),this.currentTime=0,clearInterval(this.timer.interval),this.timer.interval=setInterval(_.bind(function(){this.currentTime++,Marionette.My.messageBus.global.vent.trigger("updateTimer",100/30*this.currentTime),this.currentTime>30&&this.questionEnd()},this),1e3)},questionEnd:function(e){clearInterval(this.timer.interval),this.layout.setView(new i({isValid:e&&e.isValid||!1,model:this.i18nModel}),"content",{transition:"fade"})}})}),define("application/module/code_route/router/router",["application/module/code_route/controller/controller"],function(e){var t=Marionette.My.SubRouter.extend({initialize:function(t){this.controller=new e(t)},appRoutes:{"":"index"}});return t}),define("application/module/code_route/code_route",["system/application","application/module/code_route/router/router"],function(e,t){e.module("code_route",{startWithParent:!1,moduleClass:Marionette.My.Module,initialize:function(){this.on("start",function(e){new t(e)}),Marionette.My.Module.prototype.initialize.apply(this,arguments)}})}),define("main",["system/application_initializer","application/module/code_route/code_route"],function(e){e.start()});